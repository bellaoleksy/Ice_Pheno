---
title: "Plotting Probability"
output: html_document
date: "2024-11-23"
---

```{r}
# load libraries
library(pacman)
p_load(dplyr,dataRetrieval,lubridate,tidyr,ggplot2,viridis,readxl,imputeTS,tsibble,sjPlot,pROC,gridExtra,broom,gtsummary,patchwork, stringr)
# This is the file that combines and cleans data:
source("Input_Files/01_Data_Input.R")
```
# Plotting Probability
Now we'll plot the probability of ice as a function of time.
Here we make a new data frame with the imputed values, and add the probability of ice presence given by the model

*Keep in mind that a probability of 1 = NO ICE and a probability of 0 = ICE. (Because we are predicting ice-off dates)
```{r echo=FALSE}

probabilities_impute <- predict(trimmed_imputed_reduced_final,
  newdata = select(imputed_data_trimmed_14_23, -ice_presence), # remove real outcomes
  type = "response")
imputed_data_trimmed_prob <- imputed_data_trimmed_14_23
imputed_data_trimmed_prob$ice_probability <- probabilities_impute

```
# Cumul. Discharge and Probability of Ice
## 2014:
```{r echo=FALSE}

plot2014 <- ggplot(imputed_data_trimmed_prob %>% filter(waterYear == 2014), aes(x = wy_doy, y = ice_probability)) +
  geom_line(color = "blue") +
  geom_rect(aes(xmin=obs_ice_melt_windows$wy_doy_100_ice[obs_ice_melt_windows$waterYear == 2014], xmax=obs_ice_melt_windows$wy_doy_0_ice[obs_ice_melt_windows$waterYear == 2014], ymin=-Inf,ymax=Inf), fill="lightblue",alpha=0.01)+
  labs(title = "Predicted Probability of Ice Over Time",x = "Water Year Day of Year",y = "Probability of Ice")+ 
  theme_dark()+
  lims(x = c(200,265))+
  theme(panel.ontop=TRUE,panel.background = element_rect(fill = NA))

plot2014_2 <- ggplot(imputed_data_trimmed_prob %>% filter(waterYear == 2014), aes(x = wy_doy, y = cumulative_dis)) +
  geom_line(color = "blue") +
  geom_rect(aes(xmin=obs_ice_melt_windows$wy_doy_100_ice[obs_ice_melt_windows$waterYear == 2014], xmax=obs_ice_melt_windows$wy_doy_0_ice[obs_ice_melt_windows$waterYear == 2014], ymin=-Inf,ymax=Inf), fill="lightblue",alpha=0.01)+
  labs(
    title = "Cumulative Discharge Over Time",
    x = "Water Year Day of Year",
    y = "Cumulative Discharge (cfs)")+ lims(x = c(200,265)) + 
    theme_dark()+
  theme(panel.ontop=TRUE,panel.background = element_rect(fill = NA))

plot2014_3 <- ggplot(imputed_data_trimmed_prob %>% filter(waterYear == 2014), aes(x = wy_doy, y = temperature_C_impute)) +
  geom_line(color = "blue") +
  geom_rect(aes(xmin=obs_ice_melt_windows$wy_doy_100_ice[obs_ice_melt_windows$waterYear == 2014], xmax=obs_ice_melt_windows$wy_doy_0_ice[obs_ice_melt_windows$waterYear == 2014], ymin=-Inf,ymax=Inf), fill="lightblue",alpha=0.01)+
  theme_dark()+
  labs(
    title = "Temperature Over Time",
    x = "Water Year Day of Year",
    y = "Temperature (C)"
  ) + lims(x = c(200,265))+
  theme(panel.ontop=TRUE,panel.background = element_rect(fill = NA))

#Use patchwork library to annotate plots and combine -- I find it easier to use than gridExtra or cowplot
WY2014_all <- (plot2014 / plot2014_2 / plot2014_3) + plot_annotation(
  title = 'WY 2014',
  subtitle = str_wrap('Shaded area indicates windows from weekly photographs (full cover to no coverage)', width=50)
)
WY2014_all
```
## 2015:
```{r echo=FALSE}

plot2015 <- ggplot(imputed_data_trimmed_prob %>% filter(waterYear == 2015), aes(x = wy_doy, y = ice_probability)) +
  geom_line(color = "blue") +
  geom_rect(aes(xmin=obs_ice_melt_windows$wy_doy_100_ice[obs_ice_melt_windows$waterYear == 2015], xmax=obs_ice_melt_windows$wy_doy_0_ice[obs_ice_melt_windows$waterYear == 2015], ymin=-Inf,ymax=Inf), fill="lightblue",alpha=0.01)+
  labs(
    title = "Predicted Probability of Ice Over Time",
    x = "Water Year Day of Year",
    y = "Probability of Ice"
  )+ lims(x = c(195,265))+
  theme_dark()+
  theme(panel.ontop=TRUE,panel.background = element_rect(fill = NA))

plot2015_2 <- ggplot(imputed_data_trimmed_prob %>% filter(waterYear == 2015), aes(x = wy_doy, y = cumulative_dis)) +
  geom_line(color = "blue") +
  geom_rect(aes(xmin=obs_ice_melt_windows$wy_doy_100_ice[obs_ice_melt_windows$waterYear == 2015], xmax=obs_ice_melt_windows$wy_doy_0_ice[obs_ice_melt_windows$waterYear == 2015], ymin=-Inf,ymax=Inf), fill="lightblue",alpha=0.01)+
  labs(
    title = "Cumulative Discharge Over Time",
    x = "Water Year Day of Year",
    y = "Cumulative Discharge (cfs)") + 
    lims(x = c(195,265))+
    theme_dark()+
    theme(panel.ontop=TRUE,panel.background = element_rect(fill = NA))

grid.arrange(plot2015, plot2015_2, ncol = 1)
```
## 2016:
```{r echo=FALSE}

plot2016 <- ggplot(imputed_data_trimmed_prob %>% filter(waterYear == 2016), aes(x = wy_doy, y = ice_probability)) +
  geom_line(color = "blue") +
  geom_rect(aes(xmin=195,xmax=251,ymin=-Inf,ymax=Inf), fill="lightblue",alpha=0.01)+
  labs(
    title = "Predicted Probability of Ice Over Time",
    x = "Water Year Day of Year",
    y = "Probability of Ice"
  )+ lims(x = c(190,270))+
  theme_dark()+
  theme(panel.ontop=TRUE,panel.background = element_rect(fill = NA))

plot2016_2 <- ggplot(imputed_data_trimmed_prob %>% filter(waterYear == 2016), aes(x = wy_doy, y = cumulative_dis)) +
  geom_line(color = "blue") +
  geom_rect(aes(xmin=195,xmax=251,ymin=-Inf,ymax=Inf), fill="lightblue",alpha=0.01)+
  labs(
    title = "Cumulative Discharge Over Time",
    x = "Water Year Day of Year",
    y = "Cumulative Discharge (cfs)"
  ) + lims(x = c(190,270))+
  theme_dark()+
  theme(panel.ontop=TRUE,panel.background = element_rect(fill = NA))

grid.arrange(plot2016, plot2016_2, ncol = 1)
```
## 2017:
```{r fig.height}

plot2017 <- ggplot(imputed_data_trimmed_prob %>% filter(waterYear == 2017), aes(x = wy_doy, y = ice_probability)) +
  geom_line(color = "blue") +
  geom_rect(aes(xmin=173,xmax=243,ymin=-Inf,ymax=Inf), fill="lightblue",alpha=0.01)+
  labs(
    title = "Predicted Probability of Ice Over Time",
    x = "Water Year Day of Year",
    y = "Probability of Ice"
  )+ lims(x = c(170,260))+
  theme_dark()+
  theme(panel.ontop=TRUE,panel.background = element_rect(fill = NA))

plot2017_2 <- ggplot(imputed_data_trimmed_prob %>% filter(waterYear == 2017), aes(x = wy_doy, y = cumulative_dis)) +
  geom_line(color = "blue") +
  geom_rect(aes(xmin=173,xmax=243,ymin=-Inf,ymax=Inf), fill="lightblue",alpha=0.01)+
  labs(
    title = "Cumulative Discharge Over Time",
    x = "Water Year Day of Year",
    y = "Cumulative Discharge (cfs)"
  )+ lims(x = c(170,260)) +
  theme_dark()+
  theme(panel.ontop=TRUE,panel.background = element_rect(fill = NA))

grid.arrange(plot2017, plot2017_2, ncol = 1)
```
## 2018:
```{r echo=FALSE}

plot2018 <- ggplot(imputed_data_trimmed_prob %>% filter(waterYear == 2018), aes(x = wy_doy, y = ice_probability)) +
  geom_line(color = "blue") +
  geom_rect(aes(xmin=214,xmax=235,ymin=-Inf,ymax=Inf), fill="lightblue",alpha=0.01)+
  theme_dark() +
  labs(
    title = "Predicted Probability of Ice Over Time",
    x = "Water Year Day of Year",
    y = "Probability of Ice"
  )+ lims(x = c(200,250))+
  theme(panel.ontop=TRUE,panel.background = element_rect(fill = NA))

plot2018_2 <- ggplot(imputed_data_trimmed_prob %>% filter(waterYear == 2018), aes(x = wy_doy, y = cumulative_dis)) +
  geom_line(color = "blue") +
  geom_rect(aes(xmin=214,xmax=235,ymin=-Inf,ymax=Inf), fill="lightblue",alpha=0.01)+
  theme_dark() +
  labs(
    title = "Cumulative Discharge Over Time",
    x = "Water Year Day of Year",
    y = "Cumulative Discharge (cfs)"
  ) + lims(x = c(200,250))+
  theme(panel.ontop=TRUE,panel.background = element_rect(fill = NA))

grid.arrange(plot2018, plot2018_2, ncol = 1)
```
## 2019:
```{r echo=FALSE}

plot2019 <- ggplot(imputed_data_trimmed_prob %>% filter(waterYear == 2019), aes(x = wy_doy, y = ice_probability)) +
  geom_line(color = "blue") +
  geom_rect(aes(xmin=206,xmax=260,ymin=-Inf,ymax=Inf), fill="lightblue",alpha=0.01)+
  theme_dark() +
  labs(
    title = "Predicted Probability of Ice Over Time",
    x = "Water Year Day of Year",
    y = "Probability of Ice"
  )+ lims(x = c(200,270))+
  theme(panel.ontop=TRUE,panel.background = element_rect(fill = NA))
plot2019_2 <- ggplot(imputed_data_trimmed_prob %>% filter(waterYear == 2019), aes(x = wy_doy, y = cumulative_dis)) +
  geom_line(color = "blue") +
  geom_rect(aes(xmin=206,xmax=260,ymin=-Inf,ymax=Inf), fill="lightblue",alpha=0.01)+
  theme_dark() +
  labs(
    title = "Cumulative Discharge Over Time",
    x = "Water Year Day of Year",
    y = "Cumulative Discharge (cfs)"
  ) + lims(x = c(200,270))+
  theme(panel.ontop=TRUE,panel.background = element_rect(fill = NA))
grid.arrange(plot2019, plot2019_2, ncol = 1)
```
## 2020:
```{r echo=FALSE}

plot2020 <- ggplot(imputed_data_trimmed_prob %>% filter(waterYear == 2020), aes(x = wy_doy, y = ice_probability)) +
  geom_line(color = "blue") +
  geom_rect(aes(xmin=211,xmax=234,ymin=-Inf,ymax=Inf), fill="lightblue",alpha=0.01)+
  theme_dark() +
  labs(
    title = "Predicted Probability of Ice Over Time",
    x = "Water Year Day of Year",
    y = "Probability of Ice"
  )+ lims(x = c(200,250))+ 
  theme(panel.ontop=TRUE,panel.background = element_rect(fill = NA))
plot2020_2 <- ggplot(imputed_data_trimmed_prob %>% filter(waterYear == 2020), aes(x = wy_doy, y = cumulative_dis)) +
  geom_line(color = "blue") +
  geom_rect(aes(xmin=211,xmax=234,ymin=-Inf,ymax=Inf), fill="lightblue",alpha=0.01)+
  theme_dark() +
  labs(
    title = "Cumulative Discharge Over Time",
    x = "Water Year Day of Year",
    y = "Cumulative Discharge (cfs)"
  ) + lims(x = c(200,250))+ 
  theme(panel.ontop=TRUE,panel.background = element_rect(fill = NA))
grid.arrange(plot2020, plot2020_2, ncol = 1)
```
## 2021:
```{r echo=FALSE}

plot2021 <- ggplot(imputed_data_trimmed_prob %>% filter(waterYear == 2021), aes(x = wy_doy, y = ice_probability)) +
  geom_line(color = "blue") +
  geom_rect(aes(xmin=210,xmax=255,ymin=-Inf,ymax=Inf), fill="lightblue",alpha=0.01)+
  theme_dark() +
  labs(
    title = "Predicted Probability of Ice Over Time",
    x = "Water Year Day of Year",
    y = "Probability of Ice"
  )+ lims(x = c(200,270))+
  theme(panel.ontop=TRUE,panel.background = element_rect(fill = NA))

plot2021_2 <- ggplot(imputed_data_trimmed_prob %>% filter(waterYear == 2021), aes(x = wy_doy, y = cumulative_dis)) +
  geom_line(color = "blue") +
  geom_rect(aes(xmin=210,xmax=255,ymin=-Inf,ymax=Inf), fill="lightblue",alpha=0.01)+
  theme_dark() +
  labs(
    title = "Cumulative Discharge Over Time",
    x = "Water Year Day of Year",
    y = "Cumulative Discharge (cfs)"
  ) + lims(x = c(200,270))+
  theme(panel.ontop=TRUE,panel.background = element_rect(fill = NA))
grid.arrange(plot2021, plot2021_2, ncol = 1)
```
## 2022:
```{r echo=FALSE}

plot2022 <- ggplot(imputed_data_trimmed_prob %>% filter(waterYear == 2022), aes(x = wy_doy, y = ice_probability)) +
  geom_line(color = "blue") +
  geom_rect(aes(xmin=216,xmax=244,ymin=-Inf,ymax=Inf), fill="lightblue",alpha=0.01)+
  theme_dark() +
  labs(
    title = "Predicted Probability of Ice Over Time",
    x = "Water Year Day of Year",
    y = "Probability of Ice"
  )+ lims(x = c(210,270))+
  theme(panel.ontop=TRUE,panel.background = element_rect(fill = NA))

plot2022_2 <- ggplot(imputed_data_trimmed_prob %>% filter(waterYear == 2022), aes(x = wy_doy, y = cumulative_dis)) +
  geom_line(color = "blue") +
  geom_rect(aes(xmin=216,xmax=244,ymin=-Inf,ymax=Inf), fill="lightblue",alpha=0.01)+
  theme_dark() +
  labs(
    title = "Cumulative Discharge Over Time",
    x = "Water Year Day of Year",
    y = "Cumulative Discharge (cfs)"
  ) + lims(x = c(210,270))+
  theme(panel.ontop=TRUE,panel.background = element_rect(fill = NA))
grid.arrange(plot2022, plot2022_2, ncol = 1)
```
## 2023:
```{r echo=FALSE}

plot2023 <- ggplot(imputed_data_trimmed_prob %>% filter(waterYear == 2023), aes(x = wy_doy, y = ice_probability)) +
  geom_line(color = "blue") +
  geom_rect(aes(xmin=215,xmax=243,ymin=-Inf,ymax=Inf), fill="lightblue",alpha=0.01)+
  theme_dark() +
  labs(
    title = "Predicted Probability of Ice Over Time",
    x = "Water Year Day of Year",
    y = "Probability of Ice"
  )+ lims(x = c(210,260))+
  theme(panel.ontop=TRUE,panel.background = element_rect(fill = NA))

plot2023_2 <- ggplot(imputed_data_trimmed_prob %>% filter(waterYear == 2023), aes(x = wy_doy, y = cumulative_dis)) +
  geom_line(color = "blue") +
  geom_rect(aes(xmin=215,xmax=243,ymin=-Inf,ymax=Inf), fill="lightblue",alpha=0.01)+
  theme_dark() +
  labs(
    title = "Cumulative Discharge Over Time",
    x = "Water Year Day of Year",
    y = "Cumulative Discharge (cfs)"
  ) + lims(x = c(210,260))+
  theme(panel.ontop=TRUE,panel.background = element_rect(fill = NA))

grid.arrange(plot2023, plot2023_2, ncol = 1)
```
# Temperature and Probability of Ice:
## 2014:
```{r echo=FALSE}

plot2014_3 <- ggplot(imputed_data_trimmed_prob %>% filter(waterYear == 2014), aes(x = wy_doy, y = temperature_C_impute)) +
  geom_line(color = "blue") +
  geom_rect(aes(xmin=205,xmax=247,ymin=-Inf,ymax=Inf), fill="lightblue",alpha=0.01)+
  theme_dark()+
  labs(
    title = "Temperature Over Time",
    x = "Water Year Day of Year",
    y = "Temperature (C)"
  ) + lims(x = c(200,265))+
  theme(panel.ontop=TRUE,panel.background = element_rect(fill = NA))
grid.arrange(plot2014,plot2014_3, ncol = 1)
```
## 2015:
```{r echo=FALSE}

plot2015_3 <- ggplot(imputed_data_trimmed_prob %>% filter(waterYear == 2015), aes(x = wy_doy, y = temperature_C_impute)) +
  geom_line(color = "blue") +
  geom_rect(aes(xmin=197,xmax=239,ymin=-Inf,ymax=Inf), fill="lightblue",alpha=0.01)+
  theme_dark()+
  labs(
    title = "Temperature Over Time",
    x = "Water Year Day of Year",
    y = "Temperature (C)"
  ) + lims(x = c(195,265))+
  theme(panel.ontop=TRUE,panel.background = element_rect(fill = NA))
grid.arrange(plot2015, plot2015_3, ncol = 1)
```
## 2016:
```{r echo=FALSE}

plot2016_3 <- ggplot(imputed_data_trimmed_prob %>% filter(waterYear == 2016), aes(x = wy_doy, y = temperature_C_impute)) +
  geom_line(color = "blue") +
  geom_rect(aes(xmin=195,xmax=251,ymin=-Inf,ymax=Inf), fill="lightblue",alpha=0.01)+
  theme_dark()+
  labs(
    title = "Temperature Over Time",
    x = "Water Year Day of Year",
    y = "Temperature (C)"
  ) + lims(x = c(190,270))+
  theme(panel.ontop=TRUE,panel.background = element_rect(fill = NA))
grid.arrange(plot2016, plot2016_3, ncol = 1)
```
## 2017:
```{r echo=FALSE}

plot2017_3 <- ggplot(imputed_data_trimmed_prob %>% filter(waterYear == 2017), aes(x = wy_doy, y = temperature_C_impute)) +
  geom_line(color = "blue") +
  geom_rect(aes(xmin=173,xmax=243,ymin=-Inf,ymax=Inf), fill="lightblue",alpha=0.01)+
  theme_dark()+
  labs(
    title = "Temperature Over Time",
    x = "Water Year Day of Year",
    y = "Temperature (C)"
  ) + lims(x = c(170,260))+
  theme(panel.ontop=TRUE,panel.background = element_rect(fill = NA))
grid.arrange(plot2017, plot2017_3, ncol = 1)
```
## 2018:
```{r echo=FALSE}

plot2018_3 <- ggplot(imputed_data_trimmed_prob %>% filter(waterYear == 2018), aes(x = wy_doy, y = temperature_C_impute)) +
  geom_line(color = "blue") +
  geom_rect(aes(xmin=214,xmax=235,ymin=-Inf,ymax=Inf), fill="lightblue",alpha=0.01)+
  theme_dark() +
  labs(
    title = "Temperature Over Time",
    x = "Water Year Day of Year",
    y = "Temperature (C)"
  ) + lims(x = c(200,250))+
  theme(panel.ontop=TRUE,panel.background = element_rect(fill = NA))
grid.arrange(plot2018, plot2018_3, ncol = 1)
```
## 2019:
```{r echo=FALSE}

plot2019_3 <- ggplot(imputed_data_trimmed_prob %>% filter(waterYear == 2019), aes(x = wy_doy, y = temperature_C_impute)) +
  geom_line(color = "blue") +
  geom_rect(aes(xmin=206,xmax=260,ymin=-Inf,ymax=Inf), fill="lightblue",alpha=0.01)+
  theme_dark() +
  labs(
    title = "Temperature Over Time",
    x = "Water Year Day of Year",
    y = "Temperature (C)"
  )+ lims(x = c(200,270)) +
  theme(panel.ontop=TRUE,panel.background = element_rect(fill = NA))
grid.arrange(plot2019, plot2019_3, ncol = 1)
```
## 2020:
```{r echo=FALSE}

plot2020_3 <- ggplot(imputed_data_trimmed_prob %>% filter(waterYear == 2020), aes(x = wy_doy, y = temperature_C_impute)) +
  geom_line(color = "blue") +
  geom_rect(aes(xmin=211,xmax=234,ymin=-Inf,ymax=Inf), fill="lightblue",alpha=0.01)+
  theme_dark() +
  labs(
    title = "Temperature Over Time",
    x = "Water Year Day of Year",
    y = "Temperature (C)"
  ) + lims(x = c(200,250))+
  theme(panel.ontop=TRUE,panel.background = element_rect(fill = NA))
grid.arrange(plot2020, plot2020_3, ncol = 1)
```
## 2021:
```{r echo=FALSE}

plot2021_3 <- ggplot(imputed_data_trimmed_prob %>% filter(waterYear == 2021), aes(x = wy_doy, y = temperature_C_impute)) +
  geom_line(color = "blue") +
  geom_rect(aes(xmin=210,xmax=255,ymin=-Inf,ymax=Inf), fill="lightblue",alpha=0.01)+
  theme_dark() +
  labs(
    title = "Temperature Over Time",
    x = "Water Year Day of Year",
    y = "Temperature (C)"
  ) + lims(x = c(200,270))+
  theme(panel.ontop=TRUE,panel.background = element_rect(fill = NA))
grid.arrange(plot2021, plot2021_3, ncol = 1)
```
## 2022:
```{r echo=FALSE}

plot2022_3 <- ggplot(imputed_data_trimmed_prob %>% filter(waterYear == 2022), aes(x = wy_doy, y = temperature_C_impute)) +
  geom_line(color = "blue") +
  geom_rect(aes(xmin=216,xmax=244,ymin=-Inf,ymax=Inf), fill="lightblue",alpha=0.01)+
  theme_dark() +
  labs(
    title = "Temperature Over Time",
    x = "Water Year Day of Year",
    y = "Temperature (C)"
  )+ lims(x = c(210,270)) +
  theme(panel.ontop=TRUE,panel.background = element_rect(fill = NA))
grid.arrange(plot2022, plot2022_3, ncol = 1)
```
## 2023:
```{r echo=FALSE}

plot2023_3 <- ggplot(imputed_data_trimmed_prob %>% filter(waterYear == 2023), aes(x = wy_doy, y = temperature_C_impute)) +
  geom_line(color = "blue") +
  geom_rect(aes(xmin=215,xmax=243,ymin=-Inf,ymax=Inf), fill="lightblue",alpha=0.01)+
  theme_dark() +
  labs(
    title = "Temperature Over Time",
    x = "Water Year Day of Year",
    y = "Temperature (C)"
  ) + lims(x = c(210,260))+ 
  theme(panel.ontop=TRUE,panel.background = element_rect(fill = NA))
grid.arrange(plot2023, plot2023_3, ncol = 1)
```
As you can see, there are no temperature data for 2021 - 2023, and there is a large gap in temperature data in 2019. These years will be left out of the function used to determine the threshold of probability to use when there is no ice on The Loch.

# Plot predicted ice-off dates as a line on the plots earlier in this document
## 2014:
```{r}

plot2014 <- plot2014 +
  geom_vline(xintercept=imputed_ice_off_dates_predicted_obs$first_no_ice_predicted_doy[imputed_ice_off_dates_predicted_obs$waterYear == 2014],
             linetype="dashed")

plot2014_2 <- plot2014_2 +
  geom_vline(xintercept=imputed_ice_off_dates_predicted_obs$first_no_ice_predicted_doy[imputed_ice_off_dates_predicted_obs$waterYear == 2014],
             linetype="dashed")


plot2014_3 <- plot2014_3 +
  geom_vline(xintercept=imputed_ice_off_dates_predicted_obs$first_no_ice_predicted_doy[imputed_ice_off_dates_predicted_obs$waterYear == 2014],
             linetype="dashed")

#Use patchwork library to annotate plots and combine -- I find it easier to use than gridExtra or cowplot
WY2014_all <- (plot2014 / plot2014_2 / plot2014_3) + plot_annotation(
  title = 'WY 2014',
  subtitle = str_wrap('Shaded area indicates windows from weekly photographs (full cover to no coverage); dashed line is the predicted ice-off DOY from the logistical regression models', width=50)
)
WY2014_all

#Export file to new plot to a new Figures folder
ggsave("Figures/WY2014_probability_models_temp_cumulQ.png", dpi=600, width=4, height=8, units="in")

```

## 2015:
```{r echo=FALSE}

plot2015 <- plot2015 +
  geom_vline(xintercept=imputed_ice_off_dates_predicted_obs$first_no_ice_predicted_doy[imputed_ice_off_dates_predicted_obs$waterYear == 2015],
             linetype="dashed")

plot2015_2 <- plot2015_2 +
  geom_vline(xintercept=imputed_ice_off_dates_predicted_obs$first_no_ice_predicted_doy[imputed_ice_off_dates_predicted_obs$waterYear == 2015],
             linetype="dashed")

plot2015_3 <- plot2015_3 +
  geom_vline(xintercept=imputed_ice_off_dates_predicted_obs$first_no_ice_predicted_doy[imputed_ice_off_dates_predicted_obs$waterYear == 2015],
             linetype="dashed")

#Use patchwork library to annotate plots and combine -- I find it easier to use than gridExtra or cowplot
WY2015_all <- (plot2015 / plot2015_2 / plot2015_3) + plot_annotation(
  title = 'WY 2015',
  subtitle = str_wrap('Shaded area indicates windows from weekly photographs (full cover to no coverage); dashed line is the predicted ice-off DOY from the logistical regression models', width=50)
)
WY2015_all

#Export file to new plot to a new Figures folder
ggsave("Figures/WY2015_probability_models_temp_cumulQ.png", dpi=600, width=4, height=8, units="in")

```

## 2016:
```{r}
plot2016 <- plot2016 +
  geom_vline(xintercept=imputed_ice_off_dates_predicted_obs$first_no_ice_predicted_doy[imputed_ice_off_dates_predicted_obs$waterYear == 2016],
             linetype="dashed")

plot2016_2 <- plot2016_2 +
  geom_vline(xintercept=imputed_ice_off_dates_predicted_obs$first_no_ice_predicted_doy[imputed_ice_off_dates_predicted_obs$waterYear == 2016],
             linetype="dashed")

plot2016_3 <- plot2016_3 +
  geom_vline(xintercept=imputed_ice_off_dates_predicted_obs$first_no_ice_predicted_doy[imputed_ice_off_dates_predicted_obs$waterYear == 2016],
             linetype="dashed")

#Use patchwork library to annotate plots and combine -- I find it easier to use than gridExtra or cowplot
WY2016_all <- (plot2016 / plot2016_2 / plot2016_3) + plot_annotation(
  title = 'WY 2016',
  subtitle = str_wrap('Shaded area indicates windows from weekly photographs (full cover to no coverage); dashed line is the predicted ice-off DOY from the logistical regression models', width=50)
)
WY2016_all

#Export file to new plot to a new Figures folder
ggsave("Figures/WY2016_probability_models_temp_cumulQ.png", dpi=600, width=4, height=8, units="in")

```
## 2017:
```{r}
plot2017 <- plot2017 +
  geom_vline(xintercept=imputed_ice_off_dates_predicted_obs$first_no_ice_predicted_doy[imputed_ice_off_dates_predicted_obs$waterYear == 2017],
             linetype="dashed")

plot2017_2 <- plot2017_2 +
  geom_vline(xintercept=imputed_ice_off_dates_predicted_obs$first_no_ice_predicted_doy[imputed_ice_off_dates_predicted_obs$waterYear == 2017],
             linetype="dashed")

plot2017_3 <- plot2017_3 +
  geom_vline(xintercept=imputed_ice_off_dates_predicted_obs$first_no_ice_predicted_doy[imputed_ice_off_dates_predicted_obs$waterYear == 2017],
             linetype="dashed")

#Use patchwork library to annotate plots and combine -- I find it easier to use than gridExtra or cowplot
WY2017_all <- (plot2017 / plot2017_2 / plot2017_3) + plot_annotation(
  title = 'WY 2017',
  subtitle = str_wrap('Shaded area indicates windows from weekly photographs (full cover to no coverage); dashed line is the predicted ice-off DOY from the logistical regression models', width=50)
)
WY2017_all

#Export file to new plot to a new Figures folder
ggsave("Figures/WY2017_probability_models_temp_cumulQ.png", dpi=600, width=4, height=8, units="in")

```
## 2018:
```{r}
plot2018 <- plot2018 +
  geom_vline(xintercept=imputed_ice_off_dates_predicted_obs$first_no_ice_predicted_doy[imputed_ice_off_dates_predicted_obs$waterYear == 2018],
             linetype="dashed")

plot2018_2 <- plot2018_2 +
  geom_vline(xintercept=imputed_ice_off_dates_predicted_obs$first_no_ice_predicted_doy[imputed_ice_off_dates_predicted_obs$waterYear == 2018],
             linetype="dashed")

plot2018_3 <- plot2018_3 +
  geom_vline(xintercept=imputed_ice_off_dates_predicted_obs$first_no_ice_predicted_doy[imputed_ice_off_dates_predicted_obs$waterYear == 2018],
             linetype="dashed")

#Use patchwork library to annotate plots and combine -- I find it easier to use than gridExtra or cowplot
WY2018_all <- (plot2018 / plot2018_2 / plot2018_3) + plot_annotation(
  title = 'WY 2018',
  subtitle = str_wrap('Shaded area indicates windows from weekly photographs (full cover to no coverage); dashed line is the predicted ice-off DOY from the logistical regression models', width=50)
)
WY2018_all

#Export file to new plot to a new Figures folder
ggsave("Figures/WY2018_probability_models_temp_cumulQ.png", dpi=600, width=4, height=8, units="in")

```
## 2019:
```{r}
plot2019 <- plot2019 +
  geom_vline(xintercept=imputed_ice_off_dates_predicted_obs$first_no_ice_predicted_doy[imputed_ice_off_dates_predicted_obs$waterYear == 2019],
             linetype="dashed")

plot2019_2 <- plot2019_2 +
  geom_vline(xintercept=imputed_ice_off_dates_predicted_obs$first_no_ice_predicted_doy[imputed_ice_off_dates_predicted_obs$waterYear == 2019],
             linetype="dashed")

plot2019_3 <- plot2019_3 +
  geom_vline(xintercept=imputed_ice_off_dates_predicted_obs$first_no_ice_predicted_doy[imputed_ice_off_dates_predicted_obs$waterYear == 2019],
             linetype="dashed")

#Use patchwork library to annotate plots and combine -- I find it easier to use than gridExtra or cowplot
WY2019_all <- (plot2019 / plot2019_2 / plot2019_3) + plot_annotation(
  title = 'WY 2019',
  subtitle = str_wrap('Shaded area indicates windows from weekly photographs (full cover to no coverage); dashed line is the predicted ice-off DOY from the logistical regression models', width=50)
)
WY2019_all

#Export file to new plot to a new Figures folder
ggsave("Figures/WY2019_probability_models_temp_cumulQ.png", dpi=600, width=4, height=8, units="in")

```
## 2020:
```{r}
plot2020 <- plot2020 +
  geom_vline(xintercept=imputed_ice_off_dates_predicted_obs$first_no_ice_predicted_doy[imputed_ice_off_dates_predicted_obs$waterYear == 2020],
             linetype="dashed")

plot2020_2 <- plot2020_2 +
  geom_vline(xintercept=imputed_ice_off_dates_predicted_obs$first_no_ice_predicted_doy[imputed_ice_off_dates_predicted_obs$waterYear == 2020],
             linetype="dashed")

plot2020_3 <- plot2020_3 +
  geom_vline(xintercept=imputed_ice_off_dates_predicted_obs$first_no_ice_predicted_doy[imputed_ice_off_dates_predicted_obs$waterYear == 2020],
             linetype="dashed")

#Use patchwork library to annotate plots and combine -- I find it easier to use than gridExtra or cowplot
WY2020_all <- (plot2020 / plot2020_2 / plot2020_3) + plot_annotation(
  title = 'WY 2020',
  subtitle = str_wrap('Shaded area indicates windows from weekly photographs (full cover to no coverage); dashed line is the predicted ice-off DOY from the logistical regression models', width=50)
)
WY2020_all

#Export file to new plot to a new Figures folder
ggsave("Figures/WY2020_probability_models_temp_cumulQ.png", dpi=600, width=4, height=8, units="in")

```
## 2021:
```{r}
plot2021 <- plot2021 +
  geom_vline(xintercept=imputed_ice_off_dates_predicted_obs$first_no_ice_predicted_doy[imputed_ice_off_dates_predicted_obs$waterYear == 2021],
             linetype="dashed")

plot2021_2 <- plot2021_2 +
  geom_vline(xintercept=imputed_ice_off_dates_predicted_obs$first_no_ice_predicted_doy[imputed_ice_off_dates_predicted_obs$waterYear == 2021],
             linetype="dashed")

plot2021_3 <- plot2021_3 +
  geom_vline(xintercept=imputed_ice_off_dates_predicted_obs$first_no_ice_predicted_doy[imputed_ice_off_dates_predicted_obs$waterYear == 2021],
             linetype="dashed")

#Use patchwork library to annotate plots and combine -- I find it easier to use than gridExtra or cowplot
WY2021_all <- (plot2021 / plot2021_2 / plot2021_3) + plot_annotation(
  title = 'WY 2021',
  subtitle = str_wrap('Shaded area indicates windows from weekly photographs (full cover to no coverage); dashed line is the predicted ice-off DOY from the logistical regression models', width=50)
)
WY2021_all

#Export file to new plot to a new Figures folder
ggsave("Figures/WY2021_probability_models_temp_cumulQ.png", dpi=600, width=4, height=8, units="in")

```
## 2022:
```{r}
plot2022 <- plot2022 +
  geom_vline(xintercept=imputed_ice_off_dates_predicted_obs$first_no_ice_predicted_doy[imputed_ice_off_dates_predicted_obs$waterYear == 2022],
             linetype="dashed")

plot2022_2 <- plot2022_2 +
  geom_vline(xintercept=imputed_ice_off_dates_predicted_obs$first_no_ice_predicted_doy[imputed_ice_off_dates_predicted_obs$waterYear ==